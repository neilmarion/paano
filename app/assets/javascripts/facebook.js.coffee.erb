$ ->

  postToFeed = (link, uri, name, description)->
    # calling the API ...
    callback = (response) ->
      document.getElementById("msg").innerHTML = "Post ID: " + response["post_id"]
    obj =
      method: "feed"
      uri: uri 
      link: link 
      picture: "http://www.fbrell.com/f8.jpg"
      name: name 
      #caption: "Reference Documentation"
      description: description 

    FB.ui obj, callback
  FB.init
    appId: "<%= FB['key'] %>"
    status: true
    cookie: true

  $('.fb-share').on "click", ->
    fb_share = $(this)
    uri = "<%= FB['uri'] %>"
    link = uri+fb_share.closest('tr').find('.post-title').find('a').attr('href')
    name =  fb_share.closest('tr').find('.post-title').find('a').text()
    description =  fb_share.closest('tr').find('.preview-div.collapsed').find('p').text()
    postToFeed(link, uri, name, description) 
    false
